#### 称重问题

[toc]

#### 题目描述

> 给出一台天平和一组砝码，这些砝码的重量都是整数，假设每种重量的砝码都有无限多个，天平可以承受任意重量和任意个数的砝码，问是否可以使用这个天平和这组砝码称重任意**整数重量**的物品？输入有两行，第一行是一个正整数 $n$ ，代表这组砝码的个数，第二行是 $n$ 个整数，数字之间用空格间隔，表示这组砝码的重量。输出 `YES` 或 `NO` 表示这个天平和这组砝码是否能称重任意**整数重量**的物品。注：$0 \le$ 砝码的重量 $\le 1000000, ~~  0 \le n \le 1000000$ 。
>
> ###### 示例 $1$
>
> **输入**
>
> ```markdown
>4
> 2 4 8 2
> ```
> 
> **输出**
>
> ```markdown
>NO
> ```
> 
> ###### 示例 $2$
>
> **输入**
>
> ```markdown
>2
> 5 2
> ```
> 
> **输出**
>
> ```markdown
>YES
> ```



#### 参考思路

> ##### 问题抽象
>
> 用天平秤物品其实就是对砝码的重量做加减法，因为题目中砝码的个数是无限个，所以砝码还可以做数乘运算（乘以一个整数）。题目的场景抽象出来就是：能不能通过对一组正整数进行加、减和数乘运算得到任意的正整数。
>
> 我们仔细想一下，如果这组砝码能秤量任意整数重量的物品，那么就要能称量重量为 $1$ 的物品，而只要能秤量重量为 $1$ 的物品，就能称量重量为 $1$ 的任意非负整数倍的物品。所以，可以秤量重量为 $1$ 的物品是可以秤量重量为任意正整数重量的物品的充要条件。
>
> 用数学公式的形式表达出来：假设 $n$ 个砝码的重量为 $w_1, w_2, \dots, w_n (w_i \in N^+, 1 \le i \le n)$ ，题目中的问题等价于判断如下方程是否有解。
> $$
> w_1x_1 + w_2x_2 + \dots + w_nx_n = 1 \\
> x_i \in Z, 1 \le i \le n
> $$
>
> **温馨提示：下面有大量的数学推理，篇幅较长。想要节省时间可以直接跳到结论部分，如果希望深究其中的数学原理，建议拿上纸笔动手验证一下。**
>
> *****************************************************************************
>
> 方程 $(1)$ 可以看做 $n$ 维坐标系下两个向量的点乘，
> $$
> (w_1, w_2, \dots, w_n) \cdot (x_1, x_2, \dots ,x_n)^T = 1 \\
> w_i \in N^+, x_i \in Z, 1 \le i \le n
> $$
>
>
> 如果不考虑 $w_i, x_i$ 必须取整数值的这个限制，方程 $(1)$ 表示的其实是 $n$ 维坐标系下的一个平面，我们要找的是这个平面上是否有格点（每一维坐标值都是整数的坐标点）。方程 $(1)$ 的形式很像线性代数里的线性表示，很可惜，线性代数的知识在这里用不了，因为线性代数研究是实数域的 $n$ 维向量空间 $\R^n$下的解。
>
> 在数论中，方程 $(1)$ 是一个特殊的不定方程（也称为丢番图方程），不定方程的一般形式是：
> $$
> a_1x_1^{b_1} + a_2x_2^{b_2} + \dots + a_nx_n^{b_n} = c \\
> a_i \in Z, b_i \in Z, c \in Z, 1 \le i \le n
> $$
> 我们这里的问题是不定方程在 $b_i = 1, c = 1$ 时的特殊情况。$b_i = 1$ 时的不定方程称为一次不定方程或者线性不定方程，下面的方程是 $n$ 元一次不定方程的一般形式
> $$
> a_1x_1 + a_2x_2 + \dots + a_nx_n = c \\
> a_i \in Z, c \in Z, 1 \le i \le n
> $$
>
> *****************************************************************************
>
> ##### 二元一次不定方程的求解
>
> 这里先不给出结论，下面我们简单推理一下方程 $(4)$ 是如何求解的。先从最简单的情况入手，考虑方程：
> $$
> ax + by = c \\
> a, b, c, x, y \in Z
> $$
> 其中 $a, b, c$ 是已知的整数常量，判断是否存在整数 $x, y$ 使方程成立。
>
> 首先我们运用尝试法进行初步的思考，还是从最简单的情况入手，我们用几个数字尝试一下，比如
>
> $a = 2, b = 5$ ，对任意整数 $c$ 都有解；
>
> $a = 2, b = 4$ ，当 $c$ 是 $2$ 的倍数时才有解；
>
> $a = 8, b = 21$ ，对任意整数 $c$ 都有解；
>
> $a = 8, b = 16$ ，当 $c$ 是 $8$ 的倍数时才有解；
>
> $a = 6, b = 9$ ，当 $c$ 是 $3$ 的倍数时才有解。
>
> 多尝试几组数字就可以发现一点规律，方程解的情况好像跟 $a$ 与 $b$ 的最大公约数有关系，我们用符号 $(a, b)$ 表示 $a$ 与 $b$ 的最大公约数。猜想方程的解取决于 $\dfrac {c} {(a, b)}$ 的值。如果 $\dfrac {c} {(a, b)}$ 是整数 ，那么方程有解， 如果 $\dfrac {c} {(a, b)}$ 不是整数， 那么方程无解。我们尝试证明一下这个猜想，根据 $a$ 与 $b$ 是否为 $0$ 的讨论，可以分为下面四种情况。这四种情况的前三种都很容易理解，第四种情况我们会继续讨论求解过程。
>
>   > 1. 当 $a = 0 且 b = 0$ 时，方程的解取决于 $c$ 的值。如果 $c = 0$ ，那么方程是一个恒等式，对任意 $x, y$ 都成立，如果 $c \ne 0$ ， 那么方程无解。
>   > 2. 当  $a = 0 且 b \ne 0$ 时，方程的解取决于 $\dfrac {c} {b}$ 的值。如果 $\dfrac {c} {b}$ 是整数 ，那么方程对任意的整数 $x$ ，$（x, \dfrac {c} {b})$ 都是方程的解， 如果 $\dfrac {c} {b}$ 不是整数， 那么方程无解。
>   > 3. 当  $a \ne 0 且 b = 0$ 时，方程的解取决于 $\dfrac {c} {a}$ 的值。如果 $\dfrac {c} {a}$ 是整数 ，那么方程对任意的整数 $y$ ，$（\dfrac {c} {a}, y)$ 都是方程的解， 如果 $\dfrac {c} {a}$ 不是整数， 那么方程无解。
>   > 4. 当  $a \ne 0 且 b \ne 0$ 时，方程的解取决于 $\dfrac {c} {(a, b)}$ 的值。如果 $\dfrac {c} {(a, b)}$ 是整数 ，那么方程有解， 如果 $\dfrac {c} {(a, b)}$ 不是整数， 那么方程无解。
>
>  考虑 $a$ 与 $b$ 的关系，一定存在一个正整数 $k (k \in N^+, k \ge 1)$ 使得 $a = ka_0, b = kb_0, (a_0, b_0) = 1$ ，$k$ 就是 $a$ 与 $b$ 的最大公约数。当 $k = 1$ 时 $a$ 与 $b$ 互质，当 $k \ne 1$ 时 $a$ 与 $b$ 提取最大公因子 $k$ 之后得到的 $a_0$ 和 $b_0$ 互质，那么方程$(5)$ 可以表示成
> $$
> k(a_0x + b_0y) = c \Rightarrow a_0x + b_0y = \frac {c} {k} \Rightarrow a_0x + b_0y = \frac {c} {(a, b)} \\
> k \in N^+, k \ge 1 \\
> a_0, b_0, c, x, y \in Z \\
> (a_0, b_0) = 1
> $$
> 可以看出，方程 $(6)$ 有解的前提是 $\dfrac {c} {(a, b)}$ 是整数，因为等式左边 $a_0x + b_0y$ 是整数。那么是不是只要 $\dfrac {c} {(a, b)}$ 是整数，方程就一定有解呢。答案是肯定的。事实上，对于两个互质的整数 $a_0$ 和 $b_0$ 和两个整数变量 $x$ 与 $y$，$a_0x + b_0y$ 可以表示任意一个整数， 即 $a_0x + b_0y$ 可以表示 $1$ ，下面证明一下这个结论。
>
> 我们不妨假设 $a_0 \ge b_0$ ，我们知道有一种求两个整数的最大公约数的方法叫做[辗转相除法][辗转相除法]，那么对两个互质的整数运用辗转相除法最终得到的结果一定是 $1$，比如 $8$ 和 $21$ 这两个数是互质的，辗转相除的过程是这样的：
> $$
> a_0~~~~~~~~~~~b_0 \\
> ~\\
> 21~~~~~~~~~~~~8 \\
> ~\\
> ~5~~~~~~~~~~~~~8 \\
> ~\\
> ~5~~~~~~~~~~~~~3 \\
> ~\\
> ~2~~~~~~~~~~~~~3 \\
> ~\\
> ~2~~~~~~~~~~~~~1 \\
> ~\\
> ~1~~~~~~~~~~~~~1
> $$
> 其中每一步都是把较大的数除以较小的数取余数，假设第 $i$ 步中 $a_i \ge b_i, m_i = \lfloor \dfrac {a_i} {b_i} \rfloor, n_i = a_i \bmod b_i$，那么 $a_i = m_ib_i + n_i \Rightarrow n_i = a_i - m_ib_i$ 也就是 $a_i$ 与 $b_i$ 的余数 $n_i$ 可以用 $a_i$ 与 $b_i$ 表示。在下一次的迭代中 $a_{i+1} = b_i, b_{i+1} = n_i$ ， 而且同理 $a_{i+1}$ 与 $b_{i+1}$ 的余数 $n_{i+1}$ 可以用 $a_{i+1}$ 与 $b_{i+1}$ 表示，那么 $n_{i+1}$ 也就可以用 $a_i$ 与 $b_i$ 表示，往上推我们可以知道 $n_i$ 可以用 $a_0$ 与 $b_0$ 表示，往下推我们知道辗转相除的最终结果是 $1$ ，用 $n_f$ 表示辗转相除算法结束时的余数，即 $n_f = 1$，那么 $n_f$ 可以用 $a_0$ 与 $b_0$ 表示，即 $1$ 可以用 $a_0$ 与 $b_0$ 表示。由前面的推理过程可以知道，这样的表示里 $a_0$ 与 $b_0$ 的系数都是整数，即存在整数变量 $x$ 与 $y$，使得 $a_0x + b_0y = 1$。下面是与 $(7)$ 对应的演算过程。
> $$
> a_0 = 21~~~b_0 = 8 \\
> ~\\
> 5 = 21 - 8 \times 2 = a_0 - 2b_0 = 21 - 16 \\
> ~\\
> 3 = 8 - 5 \times 1 = b_0 - (a_0 - 2b_0) = 3b_0 - a_0 = 24 - 21 \\
> ~\\
> 2 = 5 - 3 \times 1 = (a_0 - 2b_0) - (3b_0 - a_0) = 2a_0 - 5b_0 = 42 - 40 \\
> ~\\
> 1 = 3 - 2 \times 1 = (3b_0 - a_0) - (2a_0 - 5b_0) = 8b_0 - 3a_0 = 64 - 63 \\
> ~\\
> 1 = 2 - 1 \times 1 = (2a_0 - 5b_0) - (8b_0 - 3a_0) = 5a_0 - 13b_0 = 105 - 104 \\
> $$
> 从上面的证明和 $(8)$ 的演算可以得出：**对于两个互质的整数 $a_0$ 和 $b_0$ 和两个整数变量 $x$ 与 $y$，方程 $a_0x + b_0y = 1$ 一定有解**，而且我们可以看到 $a_0$ 与 $b_0$ 表示一个整数的方式是不唯一的，这很容易理解，因为  $ab_0 + b(-a_0) = ka_0b_0 - ka_0b_0 = 0$ ，可以得到
> $$
> ax + by = c \Rightarrow ax + by + t(ab_0 - ba_0) = c \Rightarrow a(x + tb_0) + b(y - ta_0) = c \Rightarrow a(x + \frac {b} {(a, b)} t) + b(y - \frac {a} {(a, b)} t) = c \\
> t \in Z
> $$
> 所以如果 $x_0$ 和 $y_0$ 是方程 $(5)$ 的一个解，那么 $(10)$ 是方程的通解
> $$
> \left\{
>            \begin{array}{**lr**}
>            x = x_0 + \dfrac {b} {(a, b)} t  \\
>            y = y_0 - \dfrac {a} {(a, b)} t \\
>            \end{array}
> \right.
> ~~~~~~~~~~~t \in Z
> $$
>
>
> 我们可以得出结论：
> $$
> 对于 a \ne 0 且 b \ne 0 时， 二元一次不定方程 ax + by = c 有解的充分必要条件是 c 可以整除 (a, b) \\
> 当方程有解时，假设 (x_0, y_0) 是方程的一个解，方程的一般解可以表示为: \\
> ~\\
> \left\{
>            \begin{array}{**lr**}
>            x = x_0 + \dfrac {b} {(a, b)} t  \\
>            y = y_0 - \dfrac {a} {(a, b)} t \\
>            \end{array}  
> \right.
> ~~~~~~~~~~~t \in Z
> $$
>
> *****************************************************************************
>
> ##### $n$ 元一次不定方程的求解
>
> 以上解决了二元一次不定方程的求解问题，我们还需要把这个结论推广到 $n$ 元的情况。对于方程 $(4)$ ，考虑以下两种情况
>
>    > 1. 当 $a_1, a_2, \dots, a_n$ 全为 $0$ 时，如果 $c = 0$ ，那么方程是一个恒等式，对任意 $x_1, x_2, \dots, x_n$ 都成立，如果 $c \ne 0$ ， 那么方程无解。
>    > 2. 当 $a_1, a_2, \dots, a_n$ 不全为 $0$ 时，方程的解取决于 $\dfrac {c} {(a_1, a_2, \dots, a_n)}$ 的值。如果 $\dfrac {c} {(a_1, a_2, \dots, a_n)}$ 是整数 ，那么方程有解， 如果 $\dfrac {c} {(a_1, a_2, \dots, a_n)}$ 不是整数， 那么方程无解。
>
> 我们证明一下第二种情况，首先设 $k = (a_1, a_2, \dots, a_n), a_i = kb_i, 1 \le i \le n$， 那么方程 $(4)$ 可以表示为
> $$
> k(b_1x_1 + b_2x_2 + \dots + b_nx_n) = c \Rightarrow b_1x_1 + b_2x_2 + \dots + b_nx_n = \dfrac {c} {(a_1, a_2, \dots, a_n)} \\
> b_i \in Z, c \in Z, 1 \le i \le n
> $$
> 很明显方程 $(12)$ 有解的前提条件是 $\dfrac {c} {(a_1, a_2, \dots, a_n)}$ 是整数，因为等号左边是整数。然后需要证明当 $\dfrac {c} {(a_1, a_2, \dots, a_n)}$ 是整数时，方程 $(12)$ 一定有解，我们的思路是证明当 $(b_1, b_2, \dots, b_n) = 1$ （即 $b_1, b_2, \dots, b_n$ 互质）时， $b_1x_1 + b_2x_2 + \dots + b_nx_n$ 可以表示任意整数。
>
> 求 $n$ 个数的最大公约数的方法是迭代式地运用辗转相除法，即 $(b_1, b_2, \dots, b_n) = ((\dots(((b_1, b_2), b_3), b_4), \dots), b_n)$ ，参考我们对二元情况的证明， $b_1$ 与 $b_2$ 的余数 $n_{12}$ 可以用 $b_1$ 与 $b_2$ 表示，  $(b1, b2)$ 与 $b_3$ 的余数 $n_{123}$ 可以用 $n_{12}$ 与 $b_3$ 表示，也就可以用 $b_1, b_2, b_3$ 表示，递推下去就会得到 $(b_1, b_2, \dots, b_n)$ 的余数 $n_{123\dots n}$ 可以用 $b_1, b_2, \dots, b_n$ 表示，而 $n_{123\dots n} = 1$ ，所以 $1$ 可以用 $b_1, b_2, \dots, b_n$ 表示，那么 $b_1x_1 + b_2x_2 + \dots + b_nx_n$ 可以表示任意整数。
>
> 同样的，因为 
> $$
> b_1b_2 \dots a_i \dots b_n + b_1b_2 \dots (-a_j) \dots b_n = k(b_1b_2 \dots b_i \dots b_n - b_1b_2 \dots b_j \dots b_n) = 0
> $$
> 可以推出
> $$
> t_1(a_1b_2b_3 \dots b_{n-1}b_n + b_1(-a_2)b_3 \dots b_{n-1}b_n) + \\
> t_2(b_1a_2b_3 \dots b_{n-1}b_n + b_1b_2(-a_3) \dots b_{n-1}b_n) + \\
> \vdots  \\
> t_{n-1}(b_1b_2b_3 \dots a_{n-1}b_n + b_1b_2b_3 \dots b_{n-1}(-a_n) + \\
> t_n(b_1b_2b_3 \dots b_{n-1}a_n + (-a_1)b_2b_3 \dots b_{n-1}b_n = 0
> $$
> 把等式 $(14)$ 与等式 $(4)$ 相加可得
> $$
> a_1(x_1 + (t_1 - t_n)b_2b_3 \dots b_n) + a_2(x_2 + (t_2 - t_1)b_1b_3 \dots b_n) + \dots + a_n(x_n + (t_n - t_{n-1})b_1b_2 \dots b_{n-1}) = c
> $$
> 如果 $(x_{1_0}, x_{2_0}, \dots, x_{n_0})$ 方程 $(4)$ 的一个解，那么 $(16)$ 是方程的通解
> $$
> \left\{
>            \begin{array}{**lr**}
>            x_1 = x_{1_0} + \dfrac {a_2a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}} (t_1 - t_n)  \\
>            x_2 = x_{2_0} + \dfrac {a_1a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}} (t_2 - t_1)  \\
>            ~~~~~~\vdots \\
>            x_n = x_{n_0} + \dfrac {a_1a_2 \dots a_{n-1}} {(a_1, a_2, \dots, a_n)^{n-1}} (t_n - t_{n-1})  \\
>            \end{array}
> \right.
> 
> 
> ~~~~~~~~~~~t_i \in Z, 1 \le i \le n \\
> $$
> 如果令 $s_1 = t_1 - t_n, ~ s_2 = t_2 - t_1, ~ \dots, ~ s_n = t_n - t_{n-1}$，那么 $(16)$ 可以表示为
> $$
> \left\{
>            \begin{array}{**lr**}
>            x_1 = x_{1_0} + \dfrac {a_2a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}}s_1  \\
>            x_2 = x_{2_0} + \dfrac {a_1a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}}s_2  \\
>            ~~~~~~\vdots \\
>            x_n = x_{n_0} + \dfrac {a_1a_2 \dots a_{n-1}} {(a_1, a_2, \dots, a_n)^{n-1}}s_n  \\
>            \end{array}
> \right.
> 
> 
> ~~~~~~~~~~~s_i \in Z, ~ \sum {s_i} = 0, ~ 1 \le i \le n\\
> $$
>
> *****************************************************************************
>
> ##### 结论
>
> **从上面的推理，我们可以得出最终的结论**
> $$
> 对于不全为 ~0~ 的整数 ~ a_1, a_2, \dots, a_n， n ~ 元一次不定方程 ~ a_1x_1 + a_2x_2 + \dots + a_nx_n = c ~ 有解的充分必要条件是 ~c~可以整除 ~ (a_1, a_2, \dots, a_n) \\
> ~\\
> 当方程有解时，假设 x_{1_0}, x_{2_0}, \dots, x_{n_0} 是方程的一个解，方程的一般解可以表示为: \\
> ~\\
> \left\{
>            \begin{array}{**lr**}
>            x_1 = x_{1_0} + \dfrac {a_2a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}}s_1  \\
>            x_2 = x_{2_0} + \dfrac {a_1a_3 \dots a_n} {(a_1, a_2, \dots, a_n)^{n-1}}s_2  \\
>            ~~~~~~\vdots \\
>            x_n = x_{n_0} + \dfrac {a_1a_2 \dots a_{n-1}} {(a_1, a_2, \dots, a_n)^{n-1}}s_n  \\
>            \end{array}
> \right.
> 
> 
> ~~~~~~~~~~~s_i \in Z, ~ \sum {s_i} = 0, ~ 1 \le i \le n\\
> $$
>
> *****************************************************************************
>
> ##### 实现
>
> 理论上已经分析的很清楚了，解这个问题也就是判断方程 $(1)$ 是否有整数解，方法是判断 $w_1, w_2, \dots, w_n$ 的最大公约数是否为 $1$ ，求 $n$ 个整数的最大公约数的方法是层层迭代地使用辗转相除法。辗转相除法的时间复杂度是 $O(log_m)$ 的， $m$ 表示进行辗转相除法的两个整数中较大的那一个， $n$ 次迭代的时间复杂度是  $O(nlog_m)$ 的，空间上我们只需要使用两个变量来表示当前迭代中的两个整数就可以了，空间复杂度是 $O(1)$ 的。

[辗转相除法]: https://zh.wikipedia.org/wiki/%E8%BC%BE%E8%BD%89%E7%9B%B8%E9%99%A4%E6%B3%95 "辗转相除法"

#### 参考实现

```c++
#include <iostream>
using namespace std;

int gcd(int a, int b) {
    /* 递归写法
     * if (a == 0 || b == 0) {
     *     return a + b;
     * } else if (a > b) {
     *     return gcd(a % b, b);
     * } else {
     *     return gcd(b % a, a);
     * }
     */

    // 非递归写法
    int m = max(a, b), n = min(a, b), t;
    while (m > 0 && n > 0) {
        t = m % n;
        m = n;
        n = t;
    }
    return m + n;
}

int main() {
    int n = 0, wi = 0, wj = 0;

    cin >> n;
    for (int i = 0; i < n; i++) {
        cin >> wj;
        if (wj <= 0) { // 过滤掉无效输入
            continue;
        }
        if (wi == 0) { // 初始化wi
            wi = wj;
            continue;
        }
        wi = gcd(wi, wj);
        if (wi == 1) { // 已经互质，不用继续迭代下去了
            break;
        }
    }

    if (wi == 1) {
        cout << "YES" << endl;
    } else {
        cout << "NO" << endl;
    }
    return 0;
}
```

